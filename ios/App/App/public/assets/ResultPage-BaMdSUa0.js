import{a as ie,d as ne,e as le,u as ce,r as u,j as e,y as o,k as Z}from"./main-C-q4ut4N.js";import{M as oe}from"./MainLayout-BTgi3f_k.js";import"./pwa-scanner-branco-oh03E7i6.js";const l={Campe√µes:{emoji:"üèÜ",color:"#2E8B57",class:"bg-success-subtle text-success"},"Clientes fi√©is":{emoji:"ü•á",color:"#2E8B57",class:"bg-success-subtle text-success"},"Lealdade potencial":{emoji:"üéØ",color:"#FFD700",class:"bg-warning-subtle text-warning"},"Clientes Recentes":{emoji:"üë∂",color:"#FFD700",class:"bg-warning-subtle text-warning"},"Precisam de aten√ß√£o":{emoji:"‚ö†Ô∏è",color:"#DC143C",class:"bg-danger-subtle text-danger"},"Em risco":{emoji:"üö®",color:"#DC143C",class:"bg-danger-subtle text-danger"},Perdido:{emoji:"ü™¶",color:"#DC143C",class:"bg-danger-subtle text-danger"},Regular:{emoji:"üîÑ",color:"#808080",class:"bg-secondary-subtle text-secondary"},default:{emoji:"‚≠ê",color:"#808080",class:"bg-secondary-subtle text-secondary"}},de=c=>c?typeof c=="string"&&c.length>=20?c.toUpperCase():typeof c=="number"||/^\d+$/.test(c)?`ZP-${c}`:(typeof c=="string"?c:String(c)).toUpperCase():"-";function he(){var S,R,P,k,q,$,A,I,F,z,M,O,L,U,T,Q,V,G;const c=ie(),{currentScan:s,clearCurrentScan:B,processScan:H}=ne(),{isOnline:J}=le(),{scannerData:m}=ce(),[j,X]=u.useState(1),[f,_]=u.useState(!1),[w,C]=u.useState(!1),[v,W]=u.useState(!1),[h,D]=u.useState(!1),[p,Y]=u.useState("details"),K=u.useCallback(a=>{if(!a)return l.default;const r=a.recency||0,n=a.frequency||0,i=a.monetary||0;return r>=4&&n>=4&&i>=4?l.Campe√µes||l.default:r>=4&&n>=3&&i>=3?l["Clientes fi√©is"]||l.default:r>=3&&n>=2&&i>=2?l["Lealdade potencial"]||l.default:r>=4&&n<=2&&i<=2?l["Clientes Recentes"]||l.default:r<=2&&n>=3&&i>=3?l["Precisam de aten√ß√£o"]||l.default:r<=2&&n<=2&&i>=3?l["Em risco"]||l.default:r<=1&&n<=1&&i<=1?l.Perdido||l.default:l.Regular||l.default},[]);if(u.useEffect(()=>{s||c("/scanner")},[s,c]),!s)return null;const t=((S=s.result)==null?void 0:S.details)||{},ee=t.rfm||{},N=K(ee),g=((R=s.result)==null?void 0:R.scan_type)==="coupon",b=((P=s.result)==null?void 0:P.scan_type)==="loyalty_card",se=((k=s.result)==null?void 0:k.can_redeem)===!0,ae=()=>{B(),c("/scanner")},te=async()=>{var a,r;if(!s||!s.result){o.error("Dados do cupom n√£o dispon√≠veis");return}try{C(!0),console.log("Preparando para resgatar cupom...");const n=s.result;if(!m||!m.id){o.error("Dados do scanner n√£o dispon√≠veis"),console.error("Scanner Data n√£o encontrado:",m);return}if(typeof n.qrData=="string"){console.log("Enviando novo scan com redeem=true para QR:",n.qrData);const i=await H(n.qrData,!0);console.log("Resposta do resgate:",i),i&&i.processed?(o.success("Cupom resgatado com sucesso!"),D(!0),s.result=i.result,s.processed=!0):(o.error("Erro ao resgatar cupom. Tente novamente."),console.error("Erro no resgate, resposta:",i))}else{const i=((a=s.result.details)==null?void 0:a.barcode_value)||s.qrData||`zuppy://coupon/${(r=n.details)==null?void 0:r.coupon_id}`;console.log("Realizando novo scan para resgate com redeem=true");const x=await Z.post("/scanner/api/v1/scan/",{qr_code:i,scanner_id:m.id,redeem:!0});console.log("Resposta da API de resgate:",x),x&&x.success?(o.success("Cupom resgatado com sucesso!"),D(!0),s.result=x,s.processed=!0):(o.error((x==null?void 0:x.message)||"Erro ao resgatar cupom"),console.error("Erro na resposta do resgate:",x))}}catch(n){console.error("Erro ao resgatar cupom:",n),o.error(n.message||"Erro ao processar o resgate")}finally{C(!1)}},re=async a=>{if(a.preventDefault(),!s||!s.result){o.error("Dados do escaneamento n√£o dispon√≠veis");return}if(j<1){o.error("A quantidade de pontos deve ser maior que zero");return}try{_(!0),console.log("Preparando para enviar pontos...");const r=s.result;if(console.log("Dados do scan:",r),!r.scan_id){o.error("ID do scan n√£o dispon√≠vel para finalizar a opera√ß√£o"),console.error("Scan ID n√£o encontrado:",r);return}if(!m||!m.id){o.error("Dados do scanner n√£o dispon√≠veis"),console.error("Scanner Data n√£o encontrado:",m);return}const n={scan_id:r.scan_id,scanner_id:m.id,points:parseInt(j,10)};console.log("Enviando dados para API:",n),console.log("Enviando para endpoint: /scanner/api/v1/scan/finalize/");const i=await Z.post("/scanner/api/v1/scan/finalize/",n);console.log("Resposta da API:",i),i&&i.success?(o.success("Pontos adicionados com sucesso!"),W(!0),s.result=i,s.processed=!0):(o.error((i==null?void 0:i.message)||"Erro ao adicionar pontos"),console.error("Erro na resposta:",i))}catch(r){console.error("Erro ao enviar pontos:",r),o.error(r.message||"Erro ao processar a solicita√ß√£o")}finally{_(!1)}},y=a=>{Y(p===a?null:a)},E=a=>{if(!a)return"-";try{return new Date(a).toLocaleString()}catch{return a}},d=(()=>{var r,n;if(!s.processed)return{icon:"bi-hourglass-split",title:"Processando",message:"O QR code est√° sendo processado e ser√° sincronizado quando online.",colorClass:"text-warning",bgClass:"bg-warning-subtle"};if(s.status==="error")return{icon:"bi-exclamation-triangle",title:"Erro no Processamento",message:s.error||"Ocorreu um erro ao processar o QR code.",colorClass:"text-danger",bgClass:"bg-danger-subtle"};const a=s.result||{};return a.error==="COMPANY_MISMATCH"||a.message&&a.message.includes("outra empresa")?{icon:"bi-building-exclamation",title:"EMPRESA INCORRETA",message:"Este cart√£o pertence a outra empresa e n√£o pode ser processado neste scanner.",colorClass:"text-danger",bgClass:"bg-danger-subtle",type:"company-mismatch"}:a.message&&(a.message.includes("USED")||a.message.includes("EXPIRED")||a.message.includes("INVALID")||a.message.includes("usado")||a.message.includes("expirado")||a.message.includes("inv√°lido")||a.error==="INVALID_COUPON"||a.success===!1)?{icon:"bi-x-circle-fill",title:"CUPOM J√Å UTILIZADO!",message:a.message.includes("USED")||a.message.includes("usado")?"Este cupom j√° foi utilizado e n√£o pode ser resgatado novamente.":a.message.includes("EXPIRED")||a.message.includes("expirado")?"Este cupom est√° expirado e n√£o pode mais ser utilizado.":"Este cupom √© inv√°lido ou n√£o est√° dispon√≠vel para uso.",colorClass:"text-danger",bgClass:"bg-danger-subtle",type:"coupon-used"}:b?{icon:"bi-trophy",title:v?"Pontos Adicionados":"Cart√£o de Fidelidade",message:v?`${j} pontos adicionados para ${t.client_name||"o cliente"}.`:`${t.client_name||"Cliente"} - ${t.points||0} pontos atuais`,colorClass:"text-success",bgClass:"bg-success-subtle"}:g?a.status==="used"||a.status==="USED"||a.success===!1||a.details&&(a.details.status==="used"||a.details.status==="USED")?{icon:"bi-x-circle-fill",title:"CUPOM J√Å UTILIZADO!",message:"Este cupom j√° foi utilizado anteriormente e n√£o pode ser resgatado novamente.",colorClass:"text-danger",bgClass:"bg-danger-subtle",type:"coupon-used"}:{icon:"bi-ticket-perforated",title:h?"Cupom Resgatado":"Cupom Dispon√≠vel",message:h?`Cupom "${t.title||((r=a.details)==null?void 0:r.title)||"Promocional"}" resgatado com sucesso!`:`Cupom "${t.title||((n=a.details)==null?void 0:n.title)||"Promocional"}" pronto para uso.`,colorClass:h?"text-success":"text-primary",bgClass:h?"bg-success-subtle":"bg-primary-subtle"}:{icon:"bi-check-circle",title:"Processado com Sucesso",message:a.message||"QR code processado com sucesso.",colorClass:"text-success",bgClass:"bg-success-subtle"}})();return e.jsx(oe,{title:"Resultado",activeMenu:"scanner",children:e.jsx("div",{className:"container py-4",children:e.jsx("div",{className:"row justify-content-center",children:e.jsxs("div",{className:"col-md-8 col-lg-6",children:[e.jsx("div",{className:`card mb-4 border-0 shadow-sm ${d.bgClass} ${d.type||""}`,children:e.jsxs("div",{className:"card-body text-center py-4",children:[e.jsx("div",{className:`display-1 mb-3 ${d.colorClass} ${d.type==="coupon-used"?"coupon-used-icon":""}`,children:e.jsx("i",{className:`bi ${d.icon}`})}),e.jsx("h2",{className:"h3 mb-3",children:d.title}),e.jsx("p",{className:"lead mb-3",children:d.message}),!J&&!s.processed&&e.jsx("div",{className:"alert alert-warning mb-3",role:"alert",children:e.jsxs("small",{children:[e.jsx("i",{className:"bi bi-wifi-off me-2"}),"Voc√™ est√° offline. Este scan ser√° sincronizado quando voc√™ estiver online novamente."]})}),d.type==="coupon-used"&&e.jsxs("div",{className:"alert alert-danger mb-0",role:"alert",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Este cupom n√£o pode ser resgatado."]}),d.type==="company-mismatch"&&e.jsxs("div",{className:"alert alert-danger mb-0",role:"alert",children:[e.jsx("i",{className:"bi bi-building-exclamation me-2"}),"Este cart√£o pertence a outra empresa. Verifique se est√° usando o scanner correto."]})]})}),!v&&b&&((q=s.result)==null?void 0:q.requires_input)&&(($=s.result)==null?void 0:$.input_type)==="points"&&e.jsxs("div",{className:"card border-0 shadow-sm mb-4 animate__animated animate__fadeIn animate__faster",children:[e.jsx("div",{className:"card-header bg-secondary text-white",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"bi bi-pencil-square me-2"}),"Adicionar Pontos"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:re,children:[e.jsxs("div",{className:"mb-3",children:[t.client_name&&e.jsx("div",{className:"alert alert-info mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:t.client_name}),e.jsx("br",{}),e.jsxs("small",{children:["Pontos atuais: ",t.points||0]})]}),e.jsxs("span",{className:`badge ${N.class} px-2 py-1`,children:[N.emoji," ",t.tier||"Regular"]})]})}),e.jsx("label",{htmlFor:"pointsInput",className:"form-label",children:"Quantidade de pontos"}),e.jsxs("div",{className:"input-group input-group-lg mb-2",children:[e.jsx("span",{className:"input-group-text bg-secondary text-white",children:e.jsx("i",{className:"bi bi-coin me-1"})}),e.jsx("input",{type:"number",className:"form-control form-control-lg",id:"pointsInput",min:"1",max:t.operator_max_points||100,value:j,onChange:a=>X(a.target.value),required:!0,disabled:f,style:{fontSize:"1.5rem",height:"60px"}}),e.jsx("span",{className:"input-group-text",children:"pontos"})]}),t.operator_max_points&&e.jsxs("div",{className:"form-text text-end text-light bg-dark p-2 rounded mt-2",children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"M√°ximo: ",e.jsxs("strong",{children:[t.operator_max_points," pontos"]})]})]}),e.jsx("button",{type:"submit",className:"btn btn-success btn-lg w-100",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Adicionar Pontos"]})}),((I=(A=s.result)==null?void 0:A.details)==null?void 0:I.next_reward_gap)&&s.result.details.next_reward_gap.name&&e.jsx("div",{className:"alert alert-info mt-3 mb-0",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-gift-fill me-2 fs-4"}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("strong",{children:"Pr√≥xima Recompensa:"})," ",s.result.details.next_reward_gap.name,e.jsx("br",{}),e.jsx("div",{className:"progress mt-2 mb-1",style:{height:"10px"},children:e.jsx("div",{className:"progress-bar bg-success",role:"progressbar",style:{width:`${Math.max(5,100-s.result.details.next_reward_gap.missing_points/s.result.details.next_reward_gap.points_required*100)}%`},"aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("small",{children:["Faltam ",e.jsx("strong",{children:s.result.details.next_reward_gap.missing_points})," pontos (de ",s.result.details.next_reward_gap.points_required,")"]})]})]})})]})})]}),g&&se&&!h&&e.jsxs("div",{className:"card border-0 shadow-sm mb-4 animate__animated animate__pulse animate__slow animate__infinite",children:[e.jsx("div",{className:"card-header bg-warning text-dark",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"bi bi-ticket-perforated-fill me-2"}),"Cupom Dispon√≠vel para Resgate"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"alert alert-info mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:t.client_name||"Cliente"}),e.jsx("br",{}),e.jsxs("small",{children:["Cupom: ",t.title||"Dispon√≠vel para resgate"]})]}),t.expiry_date&&e.jsxs("span",{className:"badge bg-secondary px-2 py-1",children:["Exp: ",new Date(t.expiry_date).toLocaleDateString()]})]})}),e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("h4",{children:t.title||((z=(F=s.result)==null?void 0:F.details)==null?void 0:z.title)}),e.jsx("p",{className:"text-muted",children:t.description||((O=(M=s.result)==null?void 0:M.details)==null?void 0:O.description)})]}),e.jsx("button",{className:"btn btn-warning btn-lg w-100",onClick:te,disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle-fill me-2"}),"Resgatar Cupom Agora"]})})]})]}),g&&h&&e.jsxs("div",{className:"card border-0 shadow-sm mb-4",children:[e.jsx("div",{className:"card-header bg-success text-white",children:e.jsxs("h5",{className:"card-title mb-0",children:[e.jsx("i",{className:"bi bi-check-circle-fill me-2"}),"Cupom Resgatado com Sucesso"]})}),e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{className:"display-4 text-success mb-3",children:e.jsx("i",{className:"bi bi-ticket-perforated-fill"})}),e.jsx("h4",{children:t.title||"Cupom"}),e.jsx("p",{children:t.description||""}),e.jsx("div",{className:"alert alert-success mt-3",children:"Este cupom foi resgatado com sucesso e j√° n√£o est√° mais dispon√≠vel para uso."})]})]}),(b||g)&&e.jsxs("div",{className:"card mb-3 border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header bg-dark text-white d-flex justify-content-between align-items-center",onClick:()=>y("client"),style:{cursor:"pointer"},children:[e.jsxs("h5",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-person-circle me-2"}),"Informa√ß√µes do Cliente"]}),e.jsx("i",{className:`bi ${p==="client"?"bi-chevron-up":"bi-chevron-down"}`})]}),p==="client"&&e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:t.client_name||"-"}),e.jsxs("span",{className:`badge ${N.class} px-3 py-2 fs-6`,children:[N.emoji," ",t.rfm_segment||t.tier||"Regular"]}),t.program_name&&e.jsxs("div",{className:"mt-2 text-muted small",children:[e.jsx("i",{className:"bi bi-shop me-1"}),t.program_name]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"badge bg-info fs-2 fw-bold p-2 px-3",children:t.points||0}),e.jsx("div",{className:"fs-6 text-light mt-1",children:"Pontos Dispon√≠veis"})]})]}),e.jsxs("div",{className:"row g-2 mb-4",children:[t.total_earned&&e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"card bg-light h-100",children:e.jsxs("div",{className:"card-body p-2 text-center",children:[e.jsx("div",{className:"fs-4 fw-bold text-success",children:t.total_earned}),e.jsx("div",{className:"fs-7 text-muted",children:"Total Ganhos"})]})})}),t.total_spent&&e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"card bg-light h-100",children:e.jsxs("div",{className:"card-body p-2 text-center",children:[e.jsx("div",{className:"fs-4 fw-bold text-danger",children:t.total_spent}),e.jsx("div",{className:"fs-7 text-muted",children:"Total Gastos"})]})})}),t.rewards_redeemed!==void 0&&e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"card bg-light h-100",children:e.jsxs("div",{className:"card-body p-2 text-center",children:[e.jsx("div",{className:"fs-4 fw-bold text-warning",children:t.rewards_redeemed||0}),e.jsx("div",{className:"fs-7 text-muted",children:"Pr√™mios Resgatados"})]})})})]}),e.jsx("div",{className:"card bg-light mb-4",children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"text-muted",children:"C√≥digo do Cart√£o:"}),e.jsx("span",{className:"badge bg-dark px-3 py-2 fs-6",children:de(t.card_id)})]})})}),e.jsx("h5",{className:"border-bottom pb-2 mb-3",children:"Informa√ß√µes do Cliente"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-primary p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-person-fill text-white"})}),e.jsx("strong",{children:"Nome"})]}),e.jsx("div",{className:"ps-4 text-light",children:t.client_name||"-"})]})})}),e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-info p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-envelope text-white"})}),e.jsx("strong",{children:"Email"})]}),e.jsx("div",{className:"ps-4 text-light",children:t.email||"-"})]})})}),e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-success p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-phone text-white"})}),e.jsx("strong",{children:"WhatsApp"})]}),e.jsx("div",{className:"ps-4 text-light",children:t.whatsapp||"-"})]})})}),e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-warning p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-calendar-event text-white"})}),e.jsx("strong",{children:"Anivers√°rio"})]}),e.jsx("div",{className:"ps-4 text-light",children:t.birth_date||"-"})]})})})]}),e.jsx("h5",{className:"border-bottom pb-2 mb-3 mt-4",children:"Resumo do Cliente"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-primary p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-calendar-check text-white"})}),e.jsx("strong",{children:"Membro Desde"})]}),e.jsx("div",{className:"ps-4 text-light",children:E(t.member_since)||"-"})]})})}),e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card bg-dark mb-2",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("div",{className:"rounded-circle bg-info p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-clock-history text-white"})}),e.jsx("strong",{children:"√öltima Visita"})]}),e.jsx("div",{className:"ps-4 text-light",children:E(t.last_visit)||"-"})]})})})]}),t.notes&&e.jsxs("div",{className:"card bg-dark mt-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"rounded-circle bg-secondary p-1 me-2 d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:"bi bi-sticky-fill text-white"})}),e.jsx("strong",{children:"Observa√ß√µes"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("p",{className:"mb-0 text-light",children:t.notes})})]})]})]}),(b||g)&&((U=(L=s.result)==null?void 0:L.details)==null?void 0:U.available_rewards)&&s.result.details.available_rewards.length>0&&e.jsxs("div",{className:"card mb-3 border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header bg-primary text-white d-flex justify-content-between align-items-center",onClick:()=>y("rewards"),style:{cursor:"pointer"},children:[e.jsxs("h5",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-gift me-2"}),"Recompensas Dispon√≠veis (",s.result.details.available_rewards.length,")"]}),e.jsx("i",{className:`bi ${p==="rewards"?"bi-chevron-up":"bi-chevron-down"}`})]}),p==="rewards"&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"list-group",children:s.result.details.available_rewards.map((a,r)=>e.jsxs("div",{className:"list-group-item list-group-item-action",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("h6",{className:"mb-0",children:a.name}),e.jsxs("span",{className:"badge bg-primary",children:[a.points_required," pontos"]})]}),e.jsx("p",{className:"mb-0 small text-muted",children:a.description})]},a.id||r))}),s.result.details.next_reward_gap&&s.result.details.next_reward_gap.name&&e.jsx("div",{className:"alert alert-info mt-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("strong",{children:"Pr√≥xima Recompensa:"})," ",s.result.details.next_reward_gap.name,e.jsx("br",{}),e.jsxs("small",{children:["Faltam ",e.jsx("strong",{children:s.result.details.next_reward_gap.missing_points})," pontos"]})]}),e.jsxs("span",{className:"badge bg-info ms-2",children:[s.result.details.next_reward_gap.points_required," pts"]})]})})]})]}),e.jsxs("div",{className:"card mb-3 border-0 shadow-sm",children:[e.jsxs("div",{className:"card-header bg-secondary text-white d-flex justify-content-between align-items-center",onClick:()=>y("details"),style:{cursor:"pointer"},children:[e.jsxs("h5",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-info-circle me-2"}),"Detalhes da Transa√ß√£o"]}),e.jsx("i",{className:`bi ${p==="details"?"bi-chevron-up":"bi-chevron-down"}`})]}),p==="details"&&e.jsx("div",{className:"card-body",children:e.jsxs("ul",{className:"list-group list-group-flush",children:[e.jsxs("li",{className:"list-group-item d-flex justify-content-between",children:[e.jsx("span",{children:"Data/Hora:"}),e.jsx("span",{children:new Date(s.timestamp).toLocaleString()})]}),((T=s.result)==null?void 0:T.scan_id)&&e.jsxs("li",{className:"list-group-item d-flex justify-content-between",children:[e.jsx("span",{children:"ID do Scan:"}),e.jsx("span",{className:"text-muted",children:s.result.scan_id})]}),((Q=s.result)==null?void 0:Q.scan_type)&&e.jsxs("li",{className:"list-group-item d-flex justify-content-between",children:[e.jsx("span",{children:"Tipo:"}),e.jsx("span",{children:b?"Cart√£o de Fidelidade":g?"Cupom":s.result.scan_type})]}),((G=(V=s.result)==null?void 0:V.details)==null?void 0:G.program_name)&&e.jsxs("li",{className:"list-group-item d-flex justify-content-between",children:[e.jsx("span",{children:"Programa:"}),e.jsx("span",{children:s.result.details.program_name})]}),e.jsxs("li",{className:"list-group-item d-flex justify-content-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:`badge ${d.colorClass}`,children:s.processed?"Processado":"Pendente"})]})]})})]}),e.jsx("div",{className:"d-flex justify-content-center mt-4 mb-3",children:e.jsxs("button",{className:"btn btn-primary btn-lg px-5 py-3",onClick:ae,children:[e.jsx("i",{className:"bi bi-qr-code-scan me-2"}),"Novo Scan"]})})]})})})})}export{he as default};
